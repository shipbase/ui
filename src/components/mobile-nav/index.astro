---
import { docsConfig } from "@/config/docs"
import { siteConfig } from "@/config/site"
import { getDocsSidebarGroup } from "@/lib/docs"
import { cn } from "@/lib/utils"

import { Icons } from "../icons"
import { MobileNavSheet } from "./sheet"

const sidebarGroup = await getDocsSidebarGroup()

const pathname = Astro.url.pathname
---

<MobileNavSheet client:visible>
  <Fragment>
    <a href="/" class="flex items-center">
      <Icons.logo className="mr-2 h-4 w-4" />
      <span class="font-bold">{siteConfig.name}</span>
    </a>
    <nav class="my-4 h-[calc(100vh-8rem)] pb-10 pl-6 overflow-y-auto">
      <div class="flex flex-col space-y-3">
        {
          docsConfig.mainNav?.map((item) => (
            <a
              href={item.href}
              class={cn(
                pathname === item.href
                  ? "font-medium text-foreground"
                  : "text-muted-foreground"
              )}
            >
              {item.title}
            </a>
          ))
        }
      </div>
      <div class="flex flex-col space-y-3">
        {
          sidebarGroup.map((item) => (
            <div class="flex flex-col space-y-3 pt-6">
              <h4 class="font-medium">{item.title}</h4>
              {item.items.map((subitem) => (
                <a
                  href={subitem.href}
                  class={cn(
                    pathname === subitem.href
                      ? "font-medium text-foreground"
                      : "text-muted-foreground"
                  )}
                >
                  {subitem.title}
                </a>
              ))}
            </div>
          ))
        }
      </div>
    </nav>
  </Fragment>
</MobileNavSheet>
